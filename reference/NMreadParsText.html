<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read comments to parameter definitions in Nonmem control streams — NMreadParsText • NMdata</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read comments to parameter definitions in Nonmem control streams — NMreadParsText"><meta property="og:description" content="When interpreting parameter estimates, it is often needed to
recover information about the meaning of the different parameters
from control stream. `NMreadParsText` provides a flexible way to
organize the comments in the parameter sections into a
`data.frame`. This can subsequently easily be merged with parameter
values as obtained with `NMreadExt`."><meta property="og:image" content="https://nmautoverse.github.io/NMdata/reference/figures/apple-touch-icon-180x180.png"><meta property="og:image:alt" content="Efficient data preparation, consistency-checking and post-processing in PK/PD modeling"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NMdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="https://htmlpreview.github.io/?https://github.com/nmautoverse/NMdata/blob/master/vignettes/NMdata-cheat.html" class="external-link">Cheat Sheet</a>
    </li>
    <li>
      <a href="../articles/NMscanData.html">NMscanData: find and combine all output and input data</a>
    </li>
    <li>
      <a href="../articles/DataPrepare.html">Data Preparation Tools</a>
    </li>
    <li>
      <a href="../articles/NMdata-FAQ.html">FAQ</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="https://github.com/nmautoverse/NMdata/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/nmautoverse/NMdata/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read comments to parameter definitions in Nonmem control streams</h1>
    <small class="dont-index">Source: <a href="https://github.com/nmautoverse/NMdata/blob/master/R/NMreadParsText.R" class="external-link"><code>R/NMreadParsText.R</code></a></small>
    <div class="hidden name"><code>NMreadParsText.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When interpreting parameter estimates, it is often needed to
recover information about the meaning of the different parameters
from control stream. `NMreadParsText` provides a flexible way to
organize the comments in the parameter sections into a
`data.frame`. This can subsequently easily be merged with parameter
values as obtained with `NMreadExt`.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NMreadParsText</span><span class="op">(</span></span>
<span>  <span class="va">file</span>,</span>
<span>  <span class="va">lines</span>,</span>
<span>  <span class="va">format</span>,</span>
<span>  format.omega <span class="op">=</span> <span class="va">format</span>,</span>
<span>  format.sigma <span class="op">=</span> <span class="va">format.omega</span>,</span>
<span>  spaces.split <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  unique.matches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  field.idx <span class="op">=</span> <span class="st">"idx"</span>,</span>
<span>  use.idx <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">modelname</span>,</span>
<span>  <span class="va">col.model</span>,</span>
<span>  <span class="va">as.fun</span>,</span>
<span>  <span class="va">use.theta.idx</span>,</span>
<span>  <span class="va">fields</span>,</span>
<span>  fields.omega <span class="op">=</span> <span class="va">fields</span>,</span>
<span>  fields.sigma <span class="op">=</span> <span class="va">fields.omega</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>Path to the control stream to read.</p></dd>


<dt id="arg-lines">lines<a class="anchor" aria-label="anchor" href="#arg-lines"></a></dt>
<dd><p>As an alternative to `file`, the control stream or
selected lines of the control stream can be provided as a
vector of lines.</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>Defines naming and splitting of contents of lines in
parameter sections. Default is
<code>"%init;%idx;%symbol;%label;%unit"</code>. Be careful to
remember percentage symbols in front of any variable names.</p></dd>


<dt id="arg-format-omega">format.omega<a class="anchor" aria-label="anchor" href="#arg-format-omega"></a></dt>
<dd><p>Like `format`, applied to `$OMEGA`
section. Default is to reuse `format`.</p></dd>


<dt id="arg-format-sigma">format.sigma<a class="anchor" aria-label="anchor" href="#arg-format-sigma"></a></dt>
<dd><p>Like `format`, applied to `$SIGMA`
section. Default is to reuse `format.omega`.</p></dd>


<dt id="arg-spaces-split">spaces.split<a class="anchor" aria-label="anchor" href="#arg-spaces-split"></a></dt>
<dd><p>Is a blank in `fields` to be treated as a
field seperator? Default is not to (i.e. neglect spaces in
`fields`).</p></dd>


<dt id="arg-unique-matches">unique.matches<a class="anchor" aria-label="anchor" href="#arg-unique-matches"></a></dt>
<dd><p>If TRUE, each line in the control stream is
assigned to one parameter, at most. This means, if two
parameters are listed in one line, the comments will only be
used for one of the parameters, and only that parameter will
be kept in output. Where this will typically happen is in
`$OMEGA` and `$SIGMA` sections where off-diagonal may be put
on the same line as diagonal elements. Since the off-diagonal
elements are covariances of variables that have already been
identified by the diagonals, the off-diagonal elements can be
automatically described. For example, if `OMEGA(1,1)` is
between-subject variability (BSV) on CL and `OMEGA(2,2) is BSV
on V, then we know that `OMEGA(2,1)` is covariance of (BSV on)
CL and V.</p></dd>


<dt id="arg-field-idx">field.idx<a class="anchor" aria-label="anchor" href="#arg-field-idx"></a></dt>
<dd><p>If an index field is manually provided in the
control stream comments, define the name of that field in
`format` and tell `NMreadParsTab()` to use this idx to
organize especially OMEGA and SIGMA elements by pointing to it
with `field.idx`. The default is to look for a variable called
`idx`. If the index has values like 1-2 on an OMEGA or SIGMA
row, the row is interpreted as the covariance between
OMEGA/SIGMA 1 and 2.</p></dd>


<dt id="arg-use-idx">use.idx<a class="anchor" aria-label="anchor" href="#arg-use-idx"></a></dt>
<dd><p>The default method is to automatically identify
element numbering (`i` for THETAs, `i` and `j` for OMEGAs and
SIGMAs). The automated method is based on identification of
`BLOCK()` structures and numbers of initial values. Should
this fail, or should you want to control this manually, you
can include a parameter counter in the comments and have
`NMreadParsText()` use that to assign the
numbering. `use.idx=FALSE` is default and means all blocks are
handled automatically, `use.idx=TRUE` assumes you have a
counter in all sections, and a character vector like
`use.idx="omega"` can be used to denote which sections use
such a counter from the control stream. When using a counter
on OMEGA and SIGMA, off-diagonal elements MUST be denoted by
`i-j`, like `2-1` for OMEGA(2,1). See `field.idx` too.</p></dd>


<dt id="arg-modelname">modelname<a class="anchor" aria-label="anchor" href="#arg-modelname"></a></dt>
<dd><p>See ?NMscanData</p></dd>


<dt id="arg-col-model">col.model<a class="anchor" aria-label="anchor" href="#arg-col-model"></a></dt>
<dd><p>See ?NMscanData</p></dd>


<dt id="arg-as-fun">as.fun<a class="anchor" aria-label="anchor" href="#arg-as-fun"></a></dt>
<dd><p>See ?NMscanData</p></dd>


<dt id="arg-use-theta-idx">use.theta.idx<a class="anchor" aria-label="anchor" href="#arg-use-theta-idx"></a></dt>
<dd><p>If an index field in comments should be used
to number thetas. The index field is used to organize
`$OMEGA`s and `$SIGMA`s because they are matrices but I do not
see where this is advantageous to do for `$THETA`s. Default
`use.theta.idx=FALSE` which means `$THETA`s are simply
counted.</p></dd>


<dt id="arg-fields">fields<a class="anchor" aria-label="anchor" href="#arg-fields"></a></dt>
<dd><p>Deprecated. Use `format`.</p></dd>


<dt id="arg-fields-omega">fields.omega<a class="anchor" aria-label="anchor" href="#arg-fields-omega"></a></dt>
<dd><p>Deprecated. Use `format.omega`.</p></dd>


<dt id="arg-fields-sigma">fields.sigma<a class="anchor" aria-label="anchor" href="#arg-fields-sigma"></a></dt>
<dd><p>Deprecated. Use `format.sigma`.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>data.frame with parameter names and fields read from
    comments</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Off-diagonal omega and sigma elements will only be
    correctly treated if their num field specifies say 1-2 to
    specify it is covariance between 1 and 2.</p>
<p><code>SAME</code> elements in <code>$OMEGA</code> will be skipped altogether.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## setDTthreads() is only needed for CRAN. Users should not do this.</span></span></span>
<span class="r-in"><span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/openmp-utils.html" class="external-link">setDTthreads</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## end setDTthreads() for CRAN</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## notice, examples on explicitly stated lines. Most often in</span></span></span>
<span class="r-in"><span><span class="co">## practice, one would use the file argument to automatically</span></span></span>
<span class="r-in"><span><span class="co">## extract the $THETA, $OMEGA and $SIGMA sections from a control</span></span></span>
<span class="r-in"><span><span class="co">## stream.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st"></span></span></span>
<span class="r-in"><span><span class="st">$THETA  (.1)             ;[1]; LTVKA (mL/h)</span></span></span>
<span class="r-in"><span><span class="st">$OMEGA  BLOCK(3)</span></span></span>
<span class="r-in"><span><span class="st">0.126303  ;    IIV.CL  ; 1   ;IIV     ;Between-subject variability on CL;-</span></span></span>
<span class="r-in"><span><span class="st">0.024  ; IIV.CL.V2.cov  ; 1-2 ;IIV     ;Covariance of BSV on CL and V2;-</span></span></span>
<span class="r-in"><span><span class="st">0.127  ;    IIV.V2  ; 2   ;IIV     ;Between-subject variability on V2;-</span></span></span>
<span class="r-in"><span><span class="st">0.2  ; IIV.CL.V3.cov  ; 1-3 ;IIV     ;Covariance of BSV on CL and V3;-</span></span></span>
<span class="r-in"><span><span class="st">0.2  ; IIV.V2.V3.cov  ; 2-3 ;IIV     ;Covariance of BSV on V2 and V3;-</span></span></span>
<span class="r-in"><span><span class="st">0.38  ;    IIV.V3  ; 3   ;IIV     ;Between-subject variability on V3;-</span></span></span>
<span class="r-in"><span><span class="st">$OMEGA 0 FIX ; IIV.KA ; 4  ;IIV     ;Between-subject variability on KA;-</span></span></span>
<span class="r-in"><span><span class="st">$SIGMA 1</span></span></span>
<span class="r-in"><span><span class="st">"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">text</span>,split<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">NMreadParsText</span><span class="op">(</span>lines<span class="op">=</span><span class="va">lines</span>,</span></span>
<span class="r-in"><span>format<span class="op">=</span><span class="st">"%init;[%num];%symbol"</span>,</span></span>
<span class="r-in"><span>format.omega<span class="op">=</span><span class="st">"%init; %symbol ; %num ; %type   ; %label ; %unit"</span>,</span></span>
<span class="r-in"><span>field.idx<span class="op">=</span><span class="st">"num"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## BLOCK() SAME are skipped</span></span></span>
<span class="r-in"><span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">$THETA</span></span></span>
<span class="r-in"><span><span class="st">(0,0.1) ; THE1      - 1) 1st theta</span></span></span>
<span class="r-in"><span><span class="st">(0,4.2) ; THE2        - 2) 2nd theta</span></span></span>
<span class="r-in"><span><span class="st">$OMEGA  0.08   ;    IIV.TH1  ; 1  ;IIV</span></span></span>
<span class="r-in"><span><span class="st">$OMEGA  BLOCK(1)</span></span></span>
<span class="r-in"><span><span class="st">0.547465  ; IOV.TH1  ; 2 ;IOV</span></span></span>
<span class="r-in"><span><span class="st">$OMEGA  BLOCK(1) SAME</span></span></span>
<span class="r-in"><span><span class="st">$OMEGA  BLOCK(1) SAME"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">text</span>,split<span class="op">=</span><span class="st">"\n"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">NMreadParsText</span><span class="op">(</span>lines<span class="op">=</span><span class="va">lines</span>,</span></span>
<span class="r-in"><span>                         format<span class="op">=</span><span class="st">"%init;%symbol - %idx) %label"</span>,</span></span>
<span class="r-in"><span>                         format.omega<span class="op">=</span><span class="st">"%init; %symbol  ; %idx  ; %label "</span></span></span>
<span class="r-in"><span>                         <span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Philip Delff.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>




  <script data-goatcounter="https://nmdata.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

